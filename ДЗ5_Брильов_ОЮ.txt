use mydb;

-- 1
SELECT od.*, (SELECT customer_id FROM orders AS o WHERE od.order_id = o.customer_id) as customer_id
FROM order_details as od;

-- 2
SELECT od.* 
FROM order_details as od
WHERE order_id IN (SELECT id FROM orders AS o WHERE o.shipper_id = 3);

-- 3
SELECT temp.id, AVG(temp.quantity)
FROM (SELECT * FROM order_details WHERE quantity > 10) as temp
GROUP BY temp.id;

-- 4
SELECT @@version;

WITH temp1 AS (SELECT * FROM order_details WHERE quantity > 10)
SELECT temp1.id, AVG(temp1.quantity) AS average_quantity
FROM temp1
GROUP BY temp1.id;

-- 5
DROP FUNCTION IF EXISTS new_function;

DELIMITER //
CREATE FUNCTION `new_function` (
num1 float,
num2 float
)
RETURNS float
NO SQL
DETERMINISTIC
BEGIN
	DECLARE result float;
    SET result = num1 / num2;
	RETURN result;
END
//
DELIMITER ;

SELECT quantity, new_function(quantity,4.0) AS quantity_divided_by_any_number
FROM order_details;